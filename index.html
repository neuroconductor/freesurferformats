<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Read and Write FreeSurfer Neuroimaging File Formats â€¢ freesurferformats</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Read and Write FreeSurfer Neuroimaging File Formats">
<meta property="og:description" content="Provides functions to read and write neuroimaging data in
        various file formats, with a focus on FreeSurfer
        &lt;http://freesurfer.net/&gt; formats. This includes, but is not
        limited to, the following file formats: 1) MGH/MGZ format
        files, which can contain multi-dimensional images or other
        data. Typically they contain time-series of three-dimensional
        brain scans acquired by magnetic resonance imaging (MRI). They
        can also contain vertex-wise measures of surface morphometry
        data. The MGH format is named after the Massachusetts General
        Hospital, and the MGZ format is a compressed version of the
        same format. 2) FreeSurfer morphometry data files in binary
        curv format. These contain vertex-wise surface measures,
        i.e., one scalar value for each vertex of a brain surface mesh.
        These are typically values like the cortical thickness or brain
        surface area at each vertex. 3) Annotation file format. This
        contains a brain surface parcellation derived from a cortical
        atlas. 4) Surface file format. Contains a brain surface mesh,
        given by a list of vertices and a list of faces.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">freesurferformats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/freesurferformats.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/freesurferformats_header.html">Computing volume header data with freesurferformats</a>
    </li>
    <li>
      <a href="articles/freesurferformats_write.html">Writing FreeSurfer neuroimaging data with freesurferformats</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dfsp-spirit/freesurferformats/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="freesurferformats" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#freesurferformats" class="anchor" aria-hidden="true"></a>freesurferformats</h1></div>
<p>GNU R package to read and write (not only) FreeSurfer neuroimaging file formats. Comes with support for many standard mesh file formats.</p>
<div class="figure">
<img src="./vignettes/rgl_brain_aparc.jpg?raw=true" title="An aparc brain atlas visualization, created with the fsbrain R package." alt=""><p class="caption">Vis</p>
</div>
<p><a href="#supported-formats">Supported formats</a> | <a href="#installation">Installation</a> | <a href="#documentation">Documentation</a> | <a href="#license">License</a> | <a href="#citation">Citation</a> | <a href="#development">Development</a></p>
<div id="a-note-to-end-users" class="section level2">
<h2 class="hasAnchor">
<a href="#a-note-to-end-users" class="anchor" aria-hidden="true"></a>A note to end users</h2>
<p>This low-level package provides well-tested file format readers and writers for <a href="http://freesurfer.net" class="external-link">FreeSurfer</a> neuroimaging data. Typically, you want to access not only individual files, but datasets of subjects stored in the standardized output structure of recon-all (your $SUBJECTS_DIR) when doing neuroimaging research. In that case, I recommend to use the high-level functions from the <a href="https://github.com/dfsp-spirit/fsbrain" class="external-link">fsbrain package</a> instead of re-inventing the wheel. The <em>fsbrain</em> package is built on top of <em>freesurferformats</em> and provides functions for working with the data of your study, including visualization of results on brain meshes.</p>
</div>
<div id="supported-formats" class="section level2">
<h2 class="hasAnchor">
<a href="#supported-formats" class="anchor" aria-hidden="true"></a>Supported formats</h2>
<p>You do <strong>not</strong> need to have FreeSurfer installed to use this package. It implements its own readers and writers for the following file formats:</p>
<ul>
<li><p>MGH/MGZ: FreeSurfer 4-dimensional brain images or arbitrary other data. Typically a single 3D brain MRI scan or a time series of scans, or morphometry data for brain surfaces. The format is named after the Massachusetts General Hospital, and the specs are given (rather implicitely) <a href="https://surfer.nmr.mgh.harvard.edu/fswiki/FsTutorial/MghFormat" class="external-link">here in the FreeSurfer wiki</a>. MGZ is just a gzipped version of MGH. An example file from the <em>recon-all</em> output for a subject would be <code>mri/T1.mgz</code> (containing a 3D brain volume), but also <code>surf/lh.area.fwhm15.fsaverage.mgh</code> (containing surface data mapped to standard space). This format can be read and written. Reading and writing header data is also supported, and transforms like the ras2vox matrix can be computed from the header, allowing for the proper orientation of the voxel data in different spaces.</p></li>
<li><p>FreeSurfer <em>curv</em> format: Morphometry data for a brain surface, one scalar per vertex. Could be the thickness or area of the cerebral cortex at each mesh vertex. Two versions of this format exist, an ASCII version and a binary version (the only one that is used in current FreeSurfer versions). An example file would be <code>surf/lh.area</code>. Both versions of this format can be read and written.</p></li>
<li><p>FreeSurfer annotation file format: Contains a cortical parcellation. A cortical parcellation originates from a brain atlas and contains a label for each vertex of a surface that assigns this vertex to one of a set of atlas regions. (Put another way, a parcellation splits the brain surface into disjunct atlas regions). The file format also contains a colortable, which assigns a color code to each atlas region. An example file would be <code>labels/lh.aparc.annot</code>. This format can be read and written. The standard atlases that come with FreeSurfer are Desikan-Killiany (<code>aparc</code>), DKT (<code>aparc.DKTatlas40</code>), and Destrieux (<code>aparc.a2009s</code>).</p></li>
<li><p>FreeSurfer surface file format: Contains a brain surface mesh in a binary format. Such a mesh is defined by a list of vertices (each vertex is given by its x,y,z coords) and a list of faces (each face is given by three vertex indices). An example file would be <code>surf/lh.white</code>. This format can be read and written. Reading and writing the ASCII version of the FreeSurfer surface format (<code>.asc</code> files) is also supported.</p></li>
<li><p>Other mesh file formats: Read and write support is available for meshes in VTK ASCII format (<code>.vtk</code> files), Surf-Ice format (<code>.mz3</code>), Wavefront object format (<code>.obj</code>), Object File Format (<code>.off</code>), Brainvoyager SRF format (<code>.srf</code>), and Stanford triangle format (<code>.ply</code>). Additionally, meshes can be exported in PLY2 format (<code>.ply2</code>). Meshes can be imported from files in BYU format (<code>.byu</code>), GEO format (<code>.geo</code>) and TRI format (also known as ICO mesh format, <code>.tri</code>).</p></li>
<li><p>FreeSurfer label file format: Contains a list of vertices included in a label. A label is like a mask, and is typically used to describe the vertices which are part of a certain brain region. An example file would be <code>label/lh.cortex.label</code>. Volume labels are also supported. This format can be read and written.</p></li>
<li><p>FreeSurfer color lookup table (LUT) file format: Contains a color lookup table in ASCII format. This LUT assigns names and RGBA color values to a set of structures (typically brain regions). LUT data can also be extracted from an annotation, and a set of labels and a LUT can be merged into an annotation. An example file would be <code>FREESURFER_HOME/FreeSurferColorLUT.txt</code>. This format can be read and written.</p></li>
<li><p>FreeSurfer <em>weight</em> file format: Contains one value per listed vertex. In contrast to curv files, weight files contain values not for all vertices of a surface, but only for a subset of vertices defined by their indices. The format is known as <em>weight</em> format, <em>paint</em> format, or simply <em>w</em> format. This format can be read and written.</p></li>
<li><p>FreeSurfer <em>patch</em> file format: Contains a subset of a surface (a <em>surface patch</em>), given by the vertex indices (and the faces in the ASCII version). For each patch vertex, it also stores whether the vertex is part of the patch border. This format can be read and written.</p></li>
<li><p>FreeSurfer spatial transformation matrices can be read from LTA, register.dat, and xfm files.</p></li>
<li><p>NIFTI v1: FreeSurfer morphometry data in NIFTI v1 format (including <code>.nii</code> and <code>.nii.gz</code>) files can be read and written with our own NIFTI v1 support. FreeSurfer NIFTI v1 files that use the (non-standard) FreeSurfer NIFTI hack are also supported. These files are created by FreeSurfer tools if NIFTI output is requested and one dimension of the data is larger than the 32k entries allowed by the NIFTI v1 standard. This affects virtually all surface-based data files because the brain surface meshes in FreeSurfer typically have more than 100k vertices.</p></li>
<li><p>NIFTI v2: This package comes with its own NIFTI v2 reader and writer. The 2nd format version supports larger data dimensions and drops backwards compatibility with older NIFTI-style file formats like ANALYZE.</p></li>
</ul>
<p>We also provide wrappers and adapter functions for existing neuroimaging file format packages, which load the data into <em>freesurferformats</em> data structures:</p>
<ul>
<li><p>NIFTI volumes (v1, single file): Reading is supported based on the <a href="https://CRAN.R-project.org/package=oro.nifti" class="external-link">oro.nifti</a> package. The result is transformed into an <code>fs.volume</code> instance, including computation of transformation matrices like vox2ras from the NIFTI header q-form/s-form, so NIFTI volumes can be used just like MGH/MGZ volumes. (Note: If you do not need the FreeSurfer-style transforms and all you want is to read NIFTI files, you should use <code>oro.nifti</code> directly.) Alternatively, our internal reader can be used.</p></li>
<li><p>GIFTI: General reading is supported based on the <a href="https://CRAN.R-project.org/package=gifti" class="external-link">gifti</a> and <a href="https://CRAN.R-project.org/package=xml2" class="external-link">xml2</a> packages. GIFTI is a very versatile format that can hold different kinds of data, and <em>freesurferformats</em> provides custom readers for morphometry data, surface meshes, labels and annotations. The <em>freesurferformats</em> also comes with GIFTI write support, including a general data array writer as well as custom writers for the previously listed kinds of neuroimaging data.</p></li>
<li><p>CIFTI: Reading of morphometry data from CIFTI v2 files (<code>.dscalar.nii</code>) is supported based on the <a href="https://CRAN.R-project.org/package=cifti" class="external-link">cifti package by John Muschelli</a>. The wrapper functions in freesurferformats support extraction of the data for a specific brain model (surface mesh), and map the data to the appropriate vertex indices of the surface based on the CIFTI metadata.</p></li>
</ul>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor" aria-hidden="true"></a>Installation</h2>
<p><strong>This software is for research puposes only and shall not be used for any clinical use.</strong></p>
<p>The package is on <a href="https://CRAN.R-project.org/package=freesurferformats" class="external-link">CRAN</a>, so you can simply:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"freesurferformats"</span><span class="op">)</span></code></pre></div>
<p><a href="https://CRAN.R-project.org/package=freesurferformats" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/freesurferformats"></a></p>
<p>The package is also available from <a href="https://neuroconductor.org/package/freesurferformats" class="external-link">neuroconductor</a>.</p>
<p>In case something goes wrong, donâ€™t worry. Just install the missing <a href="#system-dependencies">system dependencies</a> and retry.</p>
<div id="system-dependencies" class="section level3">
<h3 class="hasAnchor">
<a href="#system-dependencies" class="anchor" aria-hidden="true"></a>System dependencies</h3>
<p><em>Note:</em> You can ignore this section unless you want to build the freesurferformats package from the source code.</p>
<p>A <em>system dependency</em> is a <strong>non-R</strong> software that is needed for the installation of a package. System dependencies cannot be installed automatically using the R package system, so you need to install them manually or using the package manager of your operating system.</p>
<p>If you install R packages from source (the default under Linux) and want support for the GIFTI XML file format, you will need <code>libxml2-dev</code>. If you do not have it installed already, before installing <em>freesurferformats</em>, run the following command in your system shell (not in R):</p>
<ul>
<li>for deb-based Linux distributions (Debian, Ubuntu, â€¦):</li>
</ul>
<pre class="shell"><code>sudo apt-get install libxml2-dev</code></pre>
<ul>
<li>for rpm-based Linux distributions (Fedora, CentOS, RHEL, â€¦):</li>
</ul>
<pre class="shell"><code>sudo yum install libxml2-devel</code></pre>
</div>
</div>
<div id="documentation" class="section level2">
<h2 class="hasAnchor">
<a href="#documentation" class="anchor" aria-hidden="true"></a>Documentation</h2>
<div id="quick-usage" class="section level3">
<h3 class="hasAnchor">
<a href="#quick-usage" class="anchor" aria-hidden="true"></a>Quick Usage</h3>
<p>Before using any functions, of course load the package itself:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/dfsp-spirit/freesurferformats" class="external-link">"freesurferformats"</a></span><span class="op">)</span></code></pre></div>
<p>Now you can call the following functions:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/read.fs.mgh.html">read.fs.mgh</a></span><span class="op">(</span><span class="op">)</span>         <span class="co"># read volume or morphometry data from files in MGH or MGZ format, e.g., `mri/brain.mgz` or `surf/lh.area.fwhm10.fsaverage.mgh`.</span>
<span class="fu"><a href="reference/read.fs.curv.html">read.fs.curv</a></span><span class="op">(</span><span class="op">)</span>        <span class="co"># read morphometry data from 'curv' format files like `surf/lh.area`</span>
<span class="fu"><a href="reference/read.fs.morph.html">read.fs.morph</a></span><span class="op">(</span><span class="op">)</span>       <span class="co"># read any morphometry file (mgh/mgz/curv). The format is derived from the file extension.</span>
<span class="fu"><a href="reference/read.fs.annot.html">read.fs.annot</a></span><span class="op">(</span><span class="op">)</span>       <span class="co"># read annotation data or brain atlas labels from files like `label/lh.aparc.annot`</span>
<span class="fu"><a href="reference/read.fs.surface.html">read.fs.surface</a></span><span class="op">(</span><span class="op">)</span>     <span class="co"># read a surface mesh, like `surf/lh.white`, supports many standard mesh formats</span>
<span class="fu"><a href="reference/read.fs.label.html">read.fs.label</a></span><span class="op">(</span><span class="op">)</span>       <span class="co"># read a label file, like `label/lh.cortex.label`</span>
<span class="fu"><a href="reference/read.fs.colortable.html">read.fs.colortable</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># read a color lookup table (LUT), like `$FREESURFER_HOME/FreeSurferColorLUT.txt`</span>
<span class="fu"><a href="reference/read.fs.weight.html">read.fs.weight</a></span><span class="op">(</span><span class="op">)</span>      <span class="co"># read scalar data for a subset of vertices, defined by index. Known as `weight`, `paint` or simply `w` format.</span>
<span class="fu"><a href="reference/read.fs.patch.html">read.fs.patch</a></span><span class="op">(</span><span class="op">)</span>       <span class="co"># read a surface patch, which is a part of a surface.</span>
<span class="fu"><a href="reference/read.fs.transform.html">read.fs.transform</a></span><span class="op">(</span><span class="op">)</span>   <span class="co"># read spatial transformation matrix</span>

<span class="fu"><a href="reference/write.fs.mgh.html">write.fs.mgh</a></span><span class="op">(</span><span class="op">)</span>        <span class="co"># write data with 1 to 4 dimensions to an MGH format file</span>
<span class="fu"><a href="reference/write.fs.curv.html">write.fs.curv</a></span><span class="op">(</span><span class="op">)</span>       <span class="co"># write a data vector to a 'curv' format file</span>
<span class="fu"><a href="reference/write.fs.morph.html">write.fs.morph</a></span><span class="op">(</span><span class="op">)</span>      <span class="co"># write any morphometry file (mgh/mgz/curv). The format is derived from the file extension.</span>
<span class="fu"><a href="reference/write.fs.surface.html">write.fs.surface</a></span><span class="op">(</span><span class="op">)</span>    <span class="co"># write a surface mesh</span>
<span class="fu"><a href="reference/write.fs.label.html">write.fs.label</a></span><span class="op">(</span><span class="op">)</span>      <span class="co"># write a label file</span>
<span class="fu"><a href="reference/write.fs.annot.html">write.fs.annot</a></span><span class="op">(</span><span class="op">)</span>      <span class="co"># write an annotation file</span>
<span class="fu"><a href="reference/write.fs.colortable.html">write.fs.colortable</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># write a color lookup table (LUT)</span>
<span class="fu"><a href="reference/write.fs.weight.html">write.fs.weight</a></span><span class="op">(</span><span class="op">)</span>     <span class="co"># write scalar vertex data in weight or w format</span>
<span class="fu"><a href="reference/write.fs.patch.html">write.fs.patch</a></span><span class="op">(</span><span class="op">)</span>      <span class="co"># write a surface patch, which is a part of a surface.</span></code></pre></div>
<p>The documentation is included in the package and not repeated on this website.</p>
</div>
<div id="full-documentation" class="section level3">
<h3 class="hasAnchor">
<a href="#full-documentation" class="anchor" aria-hidden="true"></a>Full Documentation</h3>
<p>The documentation can be accessed from within an R session after you have loaded the <em>freesurferformats</em> package:</p>
<ul>
<li>Detailed vignettes with explanations and examples for the usage of all functions of the package are included, run <code>browseVignettes("freesurferformats")</code> to see them. You can also open the vignettes directly:
<ul>
<li>learn how to read neuroimaging data: <code><a href="articles/freesurferformats.html">vignette("freesurferformats")</a></code> <a href="https://cran.r-project.org/web/packages/freesurferformats/vignettes/freesurferformats.html" class="external-link">read online at CRAN</a>
</li>
<li>learn how to write neuroimaging data: <code><a href="articles/freesurferformats_write.html">vignette("freesurferformats_write")</a></code> <a href="https://cran.r-project.org/web/packages/freesurferformats/vignettes/freesurferformats_write.html" class="external-link">read online at CRAN</a>
</li>
<li>learn advanced header-based operations: <code><a href="articles/freesurferformats_header.html">vignette("freesurferformats_header")</a></code> <a href="https://cran.r-project.org/web/packages/freesurferformats/vignettes/freesurferformats_header.html" class="external-link">read online at CRAN</a>
</li>
</ul>
</li>
<li>Help for a specific function can be accessed in the usual R manner: <code>?&lt;function&gt;</code>, where you replace <code>&lt;function&gt;</code> with a function name. Like this: <code><a href="reference/read.fs.mgh.html">?read.fs.mgh</a></code>.</li>
<li>Run <code>example(&lt;function&gt;)</code> to see a live demo that uses the function <code>&lt;function&gt;</code>. Like this: <code>example(read.fs.mgh)</code>.</li>
<li>The <a href="./tests/testthat/">unit tests</a> that come with this package are essentially a list of examples that illustrate how to use the functions.</li>
</ul>
</div>
<div id="an-example-r-session-reading-berts-brain" class="section level3">
<h3 class="hasAnchor">
<a href="#an-example-r-session-reading-berts-brain" class="anchor" aria-hidden="true"></a>An example R session: Reading Bertâ€™s brain</h3>
<p>One of the example subjects that comes with FreeSurfer is <code>bert</code>. The following example shows how to load Bertâ€™s brain. If you have FreeSurfer installed, you can start GNU R by typing <code>R</code> in your favourite terminal application and run the following commands:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"freesurferformats"</span><span class="op">)</span>

<span class="co"># Load volume from file</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/dfsp-spirit/freesurferformats" class="external-link">"freesurferformats"</a></span><span class="op">)</span>
<span class="va">berts_brain</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"FREESURFER_HOME"</span><span class="op">)</span>, <span class="st">"/subjects/bert/mri/brain.mgz"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="va">mgh</span> <span class="op">=</span> <span class="fu"><a href="reference/read.fs.mgh.html">read.fs.mgh</a></span><span class="op">(</span><span class="va">berts_brain</span>, with_header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>;

<span class="co"># Compute the vox2ras matrix from the header:</span>
<span class="fu"><a href="reference/mghheader.vox2ras.html">mghheader.vox2ras</a></span><span class="op">(</span><span class="va">mgh</span><span class="op">)</span>
<span class="co">#     [,1] [,2] [,3]      [,4]</span>
<span class="co">#[1,]   -1    0    0  133.3997</span>
<span class="co">#[2,]    0    0    1 -110.0000</span>
<span class="co">#[3,]    0   -1    0  128.0000</span>
<span class="co">#[4,]    0    0    0    1.0000</span>

<span class="co"># ...and the data:</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mgh</span><span class="op">$</span><span class="va">data</span><span class="op">)</span>
<span class="co">#[1] 8.214322</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="va">mgh</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">)</span>
<span class="co"># [1] 256 256 256</span></code></pre></div>
<p>If you do not have FreeSurfer installed and thus donâ€™t have Bert, replace <code>berts_brain</code> with the example brain that comes with freesurferformats:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fsf_brain</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"brain.mgz"</span>, package <span class="op">=</span> <span class="st">"freesurferformats"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>;</code></pre></div>
</div>
</div>
<div id="license" class="section level2">
<h2 class="hasAnchor">
<a href="#license" class="anchor" aria-hidden="true"></a>License</h2>
<p>The <em>freesurferformats</em> package is <a href="https://en.wikipedia.org/wiki/Free_software" class="external-link">free software</a>, published under the <a href="https://opensource.org/licenses/MIT" class="external-link">MIT license</a>.</p>
<p>Note: The file LICENSE in this repository is a CRAN license template only (as required by CRAN) and does not contain the full MIT license text. See the file <a href="./LICENSE_FULL">LICENSE_FULL</a> for the full license text.</p>
</div>
<div id="citation" class="section level2">
<h2 class="hasAnchor">
<a href="#citation" class="anchor" aria-hidden="true"></a>Citation</h2>
<p>A paper is in the making. For now, please cite the R package. You can generate the citation for the version you use by typing the following command in R:</p>
<pre><code>citation("freesurferformats")</code></pre>
<p>This will ouput something like this (but for the version you actually used, which is important for reproducibility):</p>
<pre><code>To cite package â€˜freesurferformatsâ€™ in publications use:

  Tim SchÃ¤fer (2020). freesurferformats: Read and Write 'FreeSurfer'
  Neuroimaging File Formats. R package version 0.1.9.
  https://CRAN.R-project.org/package=freesurferformats

A BibTeX entry for LaTeX users is

  @Manual{,
    title = {freesurferformats: Read and Write 'FreeSurfer' Neuroimaging File Formats},
    author = {Tim SchÃ¤fer},
    year = {2020},
    note = {R package version 0.1.9,
    url = {https://CRAN.R-project.org/package=freesurferformats},
    doi = {10.5281/zenodo.3540434},
    url = {https://dx.doi.org/10.5281/zenodo.3540434},
  }</code></pre>
<p>The Digital Object Identifier (DOI) for <em>freesurferformats</em> is: <a href="https://dx.doi.org/10.5281/zenodo.3540434" class="external-link">10.5281/zenodo.3540434</a>. Note that this DOI always points to the latest version, so be sure to still include the package version in the citation.</p>
<p>A poster of <em>freesurferformats</em> has been presented at INSAR 2020 Annual Meeting: <a href="https://insar.confex.com/insar/2020/meetingapp.cgi/Paper/33181" class="external-link">Abstract</a>, <a href="https://insar.confex.com/insar/2020/techdemo/eposter.cgi?eposterid=227" class="external-link">ePoster</a></p>
</div>
<div id="development" class="section level2">
<h2 class="hasAnchor">
<a href="#development" class="anchor" aria-hidden="true"></a>Development</h2>
<div id="installing-the-development-version" class="section level3">
<h3 class="hasAnchor">
<a href="#installing-the-development-version" class="anchor" aria-hidden="true"></a>Installing the development version</h3>
<p>You can install the latest development version directly from Github if you need features which have not been released yet. Please run the tests before using the dev version (see the <em>Unit tests / CI</em> section below).</p>
<p>If you do not have <code>devtools</code> and related tools installed yet:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"devtools"</span>, <span class="st">"knitr"</span>, <span class="st">"rmarkdown"</span>, <span class="st">"testthat"</span>, <span class="st">"covr"</span><span class="op">)</span><span class="op">)</span>;</code></pre></div>
<p>Then:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"dfsp-spirit/freesurferformats"</span>, build_vignettes<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>While the development versions may have new features, you should not consider their API stable. Wait for the next release if you are not fine with adapting your code to API changes later. If in doubt, do <strong>not</strong> use the dev version.</p>
</div>
<div id="unit-tests-and-continuous-integration" class="section level3">
<h3 class="hasAnchor">
<a href="#unit-tests-and-continuous-integration" class="anchor" aria-hidden="true"></a>Unit tests and Continuous integration</h3>
<p>This package comes with <a href="./tests/testthat/">lots of unit tests</a>. To run them, in a clean R session:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">devtools</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dfsp-spirit/freesurferformats" class="external-link">freesurferformats</a></span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">check</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Continuous integration results:</p>
<p><a href="https://travis-ci.org/dfsp-spirit/freesurferformats" class="external-link"><img src="https://travis-ci.org/dfsp-spirit/freesurferformats.svg?branch=master" alt="Build Status"></a> Travis CI under Linux</p>
<p><a href="https://ci.appveyor.com/project/dfsp-spirit/freesurferformats" class="external-link"><img src="https://ci.appveyor.com/api/projects/status/github/dfsp-spirit/freesurferformats?branch=master&amp;svg=true" alt="AppVeyor build status"></a> AppVeyor CI under Windows</p>
<p><a href="https://codecov.io/gh/dfsp-spirit/freesurferformats" class="external-link"><img src="https://codecov.io/gh/dfsp-spirit/freesurferformats/branch/master/graph/badge.svg" alt="codecov"></a> Test coverage</p>
<p>The displayed status represents the development version. Donâ€™t worry if you are using the stable version from CRAN and CI is currently failing.</p>
</div>
<div id="contributing" class="section level3">
<h3 class="hasAnchor">
<a href="#contributing" class="anchor" aria-hidden="true"></a>Contributing</h3>
<p>If you found a bug, have any question, suggestion or comment on freesurferformats, please <a href="https://github.com/dfsp-spirit/freesurferformats/issues" class="external-link">open an issue</a>. I will definitely answer and try to help.</p>
<p>Please see <a href="CONTRIBUTING.html">CONTRIBUTING.md</a> for instructions on how to contribute code.</p>
<p>The freesurferformats package was written by <a href="http://rcmd.org/ts/" class="external-link">Tim SchÃ¤fer</a>. To contact me in person, please use the maintainer email address listed on the <a href="https://cran.r-project.org/package=freesurferformats" class="external-link">CRAN webpage for freesurferformats</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=freesurferformats">https://â€‹cloud.r-project.org/â€‹package=freesurferformats</a>
</li>
<li>Browse source code at <br><a href="https://github.com/dfsp-spirit/freesurferformats/">https://â€‹github.com/â€‹dfsp-spirit/â€‹freesurferformats/â€‹</a>
</li>
<li>Report a bug at <br><a href="https://github.com/dfsp-spirit/freesurferformats/issues">https://â€‹github.com/â€‹dfsp-spirit/â€‹freesurferformats/â€‹issues</a>
</li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Tim Sch<c3><a4>fer <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-3683-8070" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </a4></c3>
</li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Tim Sch<c3><a4>fer.</a4></c3></p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
